!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).Tapa={})}(this,(function(t){"use strict";function e(t,e=0){if(0===e)return t;let i=void 0;return function(...s){i&&clearTimeout(i),i=setTimeout((function(){t(...s)}),e||300)}}function i(t,e=0){let i=void 0;return function(...s){i||(i=setTimeout((function(){t(...s),i=null}),e||300))}}function s(t,e){Object.keys(t).forEach((i,s)=>{e(i,t[i],s)})}function r(t,e){return Object.keys(t).map((i,s)=>e(i,t[i],s))}function o(t){return null==t}function n(t){return!1===o(t)}function l(t){return Array.isArray(t)}function a(t){return"string"==typeof t}function h(t){return!1===a(t)}function d(t){return"object"==typeof t&&!l(t)&&!u(t)&&!a(t)&&null!==t}function c(t){return"function"==typeof t}function u(t){return"number"==typeof t}const v={image:!0,input:!0,br:!0,path:!0,line:!0,circle:!0,rect:!0,polygon:!0,polyline:!0,use:!0},p=(t,...e)=>{var i=t.map((t,i)=>{var s=e[i]||"";return c(s)&&(s=s()),l(s)||(s=[s]),t+(s=s.join(""))}).join("");return i=i.replace(/\<(\w*)([^\>]*)\/\>/gim,(function(t,e){return v[e.toLowerCase()]?t:t.replace("/>",`></${e}>`)}))},f=/[xy]/g;function m(){var t=(new Date).getTime();return"xxx12-xx-34xx".replace(f,(function(e){var i=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?i:3&i|8).toString(16)}))}const g=(t,e=T)=>` ${e} ${t}`,y=/^dom (.*)/gi,E=/^load (.*)/gi,C=/^bind (.*)/gi,b=":",T="|",M="dom ",N="load ",S="bind ",x=" ",A={},O=(...t)=>{var e=t.join(b);return(...t)=>M+[e,...t].join(x)},R=O,k=O,w=R("click"),D=R("dblclick"),P=R("mousedown"),$=R("mouseup"),_=R("mousemove"),L=R("mouseover"),I=R("mouseout"),B=R("mouseenter"),K=R("mouseleave"),F=R("touchstart"),U=R("touchmove"),H=R("touchend"),j=R("keydown"),z=R("keyup"),V=R("keypress"),G=R("drag"),X=R("dragstart"),W=R("drop"),Y=R("dragover"),q=R("dragenter"),J=R("dragleave"),Z=R("dragexit"),Q=R("dragout"),tt=R("dragend"),et=R("contextmenu"),it=R("change"),st=R("input"),rt=R("focus"),ot=R("focusin"),nt=R("focusout"),lt=R("blur"),at=R("paste"),ht=R("resize"),dt=R("scroll"),ct=R("submit"),ut=k("pointerdown"),vt=k("pointermove"),pt=k("pointerup"),ft=k("change","input"),mt=k("wheel","mousewheel","DOMMouseScroll"),gt=R("animationstart"),yt=R("animationend"),Et=R("animationiteration"),Ct=R("transitionstart"),bt=R("transitionend"),Tt=R("transitionrun"),Mt=R("transitioncancel"),Nt=(t,e=T)=>g(t,e),St=(t,e=T)=>g(`after(${t})`,e),xt=Nt,At=Nt,Ot=xt("ArrowUp"),Rt=xt("ArrowDown"),kt=xt("ArrowLeft"),wt=xt("ArrowRight"),Dt=xt("Enter"),Pt=xt("Space"),$t=xt("Escape"),_t=xt("isAltKey"),Lt=xt("isShiftKey"),It=xt("isMetaKey"),Bt=xt("isCtrlKey"),Kt=xt("self"),Ft=xt("fit"),Ut=xt("passive"),Ht=xt("vdom"),jt=(t=100)=>xt(`debounce(${t})`),zt=jt(1e3),Vt=xt("capture()"),Gt=St("preventDefault"),Xt=St("stopPropagation"),Wt=(t="$el")=>N+t,Yt=t=>{if(!1===Boolean(t))return"";var e=m();return A[e]=t,e},qt=()=>!0;function Jt(t,e,i,s=!1){t&&t.addEventListener(e,i,s)}function Zt(t,e,i){t&&i&&t.removeEventListener(e,i)}function Qt(t){if(t instanceof TouchEvent&&t.touches&&t.touches[0]){const{pageX:e,pageY:i}=t.touches[0];return{pageX:e,pageY:i}}const{pageX:e,pageY:i}=t;return{pageX:e,pageY:i}}function te(t){var{pageX:e,pageY:i}=Qt(t);return{x:e,y:i}}class ee{constructor(t={}){this.source="",this.sourceContext={},this.cachedCallback={},this.callbacks={},this.cachedCallback={},this.callbacks={}}getCallbacks(t){return this.callbacks[t]||(this.callbacks[t]=[]),this.callbacks[t]}setCallbacks(t,e=[]){this.callbacks[t]=e}on(t,i,s,r=0){var o=r>0?e(i,r):i;this.getCallbacks(t).push({event:t,callback:o,context:s,originalCallback:i})}off(t,e){1==arguments.length?this.setCallbacks(t):2==arguments.length&&this.setCallbacks(t,this.getCallbacks(t).filter(t=>t.originalCallback!==e))}offAll(t){Object.keys(this.callbacks).forEach(e=>{this.setCallbacks(e,this.getCallbacks(e).filter(e=>e.context!==t))})}getCachedCallbacks(t){return this.getCallbacks(t)}sendMessage(t,e,...i){Promise.resolve().then(()=>{var s=this.getCachedCallbacks(e);s&&s.filter(e=>e.originalCallback.source!==t).forEach(t=>{t.callback(...i)})})}triggerMessage(t,e,...i){Promise.resolve().then(()=>{var s=this.getCachedCallbacks(e);s?s.filter(e=>e.originalCallback.source===t).forEach(t=>{t.callback(...i)}):console.warn(e," is not valid event")})}emit(t,...e){this.sendMessage(this.source,t,...e)}trigger(t,...e){this.triggerMessage(this.source,t,...e)}}const ie={constructor:!0,initState:!0,refresh:!0,updateData:!0,initializeProperty:!0,created:!0,getRealEventName:!0,initializeStoreEvent:!0,destoryStoreEvent:!0,destroy:!0,emit:!0,trigger:!0,on:!0,off:!0,setState:!0,_reload:!0,render:!0,initialize:!0,afterRender:!0,components:!0,getRef:!0,parseTemplate:!0,childrenIds:!0,exists:!0,parseProperty:!0,parseSourceName:!0,parseComponent:!0,clean:!0,template:!0,eachChildren:!0,initializeEvent:!0,self:!0,isAltKey:!0,isCtrlKey:!0,isShiftKey:!0,isMetaKey:!0,preventDefault:!0,stopPropagation:!0,bodyMouseMove:!0,bodyMouseUp:!0};class se{constructor(t,e={}){this.context=void 0,this.options={},this.context=t,this.options=e}initialize(){}load(){}refresh(){}render(){}getRef(t){var e;return null===(e=this.context)||void 0===e?void 0:e.getRef(t)}splitMethodByKeyword(t,e){var i=t.filter(t=>t.indexOf(e+"(")>-1),s=i.map(t=>{var[i,s]=t.split(e+"(")[1].split(")")[0].trim().split(" ");return{target:i,param:s}});return[i,s]}collectProps(){var t=this.context,e=null==t?void 0:t.getMethod("__proto__"),i=[];do{if(!1===e instanceof Object)break;const s=Object.getOwnPropertyNames(e).filter(e=>t&&c(t.getMethod(e))&&!ie[e]);i.push(...s),e=e.__proto__}while(e);return i}filterProps(t){return this.collectProps().filter(e=>e.match(t))}run(){}destroy(){}}function re(t){let e={};return Object.keys(t).forEach(i=>{const s=t[i];e[s.name]=s.value}),e}function oe(t,e,i){if(e)if(i){if(r=e,(s=i).nodeType===Node.TEXT_NODE&&s!==r||s.nodeName!==r.nodeName)t.replaceChild(i.cloneNode(!0),e);else if(i.nodeType!==Node.TEXT_NODE){((t,e={},i={})=>{const s=Object.assign(Object.assign({},e),i);Object.keys(s).forEach(s=>{((t,e,i,s)=>{i?s&&i===s||((t,e,i)=>{"boolean"==typeof i?((t,e,i)=>{i?(t.setAttribute(e,e),t[e]=i):(t.removeAttribute(e),t[e]=i)})(t,e,i):t.setAttribute(e,i)})(t,e,i):((t,e,i)=>{"boolean"==typeof i?((t,e)=>{t.removeAttribute(e),t[e]=!1})(t,e):e&&((t,e)=>{t.removeAttribute(e)})(t,e)})(t,e,s)})(t,s,e[s],i[s])})})(e,re(i.attributes),re(e.attributes));let t=ne(e),s=ne(i);const r=Math.max(t.length,s.length);for(let i=0;i<r;i++)oe(e,t[i],s[i])}}else t.removeChild(e);else t.appendChild(i.cloneNode(!0));var s,r}const ne=t=>{let e=t.firstChild;if(!e)return[];let i=[];do{i.push(e),e=e.nextSibling}while(e);return i};function le(t,e){t=t.el||t,e=e.el||e;for(var i=ne(t),s=ne(e),r=Math.max(i.length,s.length),o=0;o<r;o++)oe(t,i[o],s[o])}class ae{constructor(t,e="",i={}){if(this.el=void 0,t instanceof HTMLElement)this.el=t;else{var r=document.createElement(t);e&&(r.className=e),s(i=i||{},(t,e)=>{r.setAttribute(t,e)}),this.el=r}}static create(t,e,i){return new ae(t,e,i)}static createByHTML(t){var e=ae.create("div").html(t).children();return e.length?ae.create(e[0].el):null}static createFragment(t){var e=ae.create("div");return e.html(t),ae.create(e.el||"div").createChildrenFragment()}static getScrollTop(){return Math.max(window.pageYOffset,document.documentElement.scrollTop,document.body.scrollTop)}static getScrollLeft(){return Math.max(window.pageXOffset,document.documentElement.scrollLeft,document.body.scrollLeft)}static parse(t){return(new DOMParser).parseFromString(t,"text/html")}static body(){return ae.create(document.body)}isFragment(){var t;return 11===(null===(t=this.el)||void 0===t?void 0:t.nodeType)}setAttr(t){if(!this.isFragment())return Object.keys(t).forEach(e=>{this.attr(e,t[e])}),this}attr(t,e){var i,s,r;if(!this.isFragment())return 1==arguments.length?(null===(i=this.el)||void 0===i?void 0:i.getAttribute)?null===(s=this.el)||void 0===s?void 0:s.getAttribute(t):void 0:(null===(r=this.el)||void 0===r||r.setAttribute(t,e),this)}attrKeyValue(t){var e;return this.isFragment()?{}:{[(null===(e=this.el)||void 0===e?void 0:e.getAttribute(t))||""]:this.val()}}attrs(...t){return this.isFragment()?[]:t.map(t=>{var e;return null===(e=this.el)||void 0===e?void 0:e.getAttribute(t)})}styles(...t){return t.map(t=>{var e;return(null===(e=this.el)||void 0===e?void 0:e.style)[t]})}removeAttr(t){var e;return null===(e=this.el)||void 0===e||e.removeAttribute(t),this}removeStyle(t){var e;return null===(e=this.el)||void 0===e||e.style.removeProperty(t),this}is(t){return this.el===(t.el||t)}isTag(t){var e;return(null===(e=this.el)||void 0===e?void 0:e.tagName.toLowerCase())===t.toLowerCase()}closest(t){var e;let i=this,s=!1;for(;!(s=i.hasClass(t));){if(!(null===(e=i.el)||void 0===e?void 0:e.parentNode))return null;i=ae.create(i.el.parentNode)}return s?i:null}parent(){var t;return ae.create(null===(t=this.el)||void 0===t?void 0:t.parentNode)}hasParent(){var t;return!!(null===(t=this.el)||void 0===t?void 0:t.parentNode)}removeClass(...t){var e;return null===(e=this.el)||void 0===e||e.classList.remove(...t),this}hasClass(t){var e,i;return!!(null===(e=this.el)||void 0===e?void 0:e.classList)&&(null===(i=this.el)||void 0===i?void 0:i.classList.contains(t))}addClass(...t){var e;return null===(e=this.el)||void 0===e||e.classList.add(...t),this}onlyOneClass(t){this.parent().children().forEach(e=>{e.removeClass(t)}),this.addClass(t)}toggleClass(t,e){var i;null===(i=this.el)||void 0===i||i.classList.toggle(t,e)}html(t){var e;return o(t)?null===(e=this.el)||void 0===e?void 0:e.innerHTML:(a(t)&&this.el?this.el.innerHTML=t:this.empty().append(t),this)}htmlDiff(t){le(this,t)}updateDiff(t,e="div"){le(this,ae.create(e).html(t))}updateSVGDiff(t,e="div"){le(this,ae.create(e).html(`<svg>${t}</svg>`).firstChild)}find(t){var e;return null===(e=this.el)||void 0===e?void 0:e.querySelector(t)}$(t){var e=this.find(t);return e?ae.create(e):void 0}findAll(t){var e;return null===(e=this.el)||void 0===e?void 0:e.querySelectorAll(t)}$$(t){return[...this.findAll(t)||[]].map(t=>ae.create(t))}empty(){for(var t,e,i;null===(t=this.el)||void 0===t?void 0:t.firstChild;)null===(e=this.el)||void 0===e||e.removeChild(null===(i=this.el)||void 0===i?void 0:i.firstChild);return this}append(t){var e,i,s,r;return a(t)?null===(e=this.el)||void 0===e||e.appendChild(document.createTextNode(t)):t instanceof ae&&t.el?null===(i=this.el)||void 0===i||i.appendChild(t.el):t instanceof DocumentFragment?null===(s=this.el)||void 0===s||s.appendChild(t):t instanceof HTMLElement&&(null===(r=this.el)||void 0===r||r.appendChild(t)),this}prepend(t){var e,i,s;return a(t)?null===(e=this.el)||void 0===e||e.prepend(document.createTextNode(t)):t instanceof ae&&t.el?null===(i=this.el)||void 0===i||i.prepend(t.el):null===(s=this.el)||void 0===s||s.prepend(t),this}prependHTML(t){var e=ae.create("div").html(t);return this.prepend(e.createChildrenFragment()),e}appendHTML(t){var e=ae.create("div").html(t);return this.append(e.createChildrenFragment()),e}createChildrenFragment(){const t=this.children();var e=document.createDocumentFragment();return t.forEach(t=>e.appendChild(t.el)),e}appendTo(t){const e=t instanceof ae?t.el:t;return null==e||e.appendChild(this.el),this}remove(){var t,e;return(null===(t=this.el)||void 0===t?void 0:t.parentNode)&&(null===(e=this.el)||void 0===e||e.parentNode.removeChild(this.el)),this}removeChild(t){var e;const i=t instanceof ae?t.el:t;return null===(e=this.el)||void 0===e||e.removeChild(i),this}text(t){var e;if(o(t))return null===(e=this.el)||void 0===e?void 0:e.textContent;var i=t;return t instanceof ae&&(i=t.text()),this.el&&(this.el.textContent=i),this}css(t,e){var i,s;if(2===arguments.length)Object.assign(null===(i=this.el)||void 0===i?void 0:i.style,{[t]:e});else if(n(t)){if(a(t)){return getComputedStyle(this.el)[t]}Object.assign(null===(s=this.el)||void 0===s?void 0:s.style,t)}return this}getComputedStyle(...t){const e=getComputedStyle(this.el);let i={};return t.forEach(t=>{i[t]=e[t]}),i}getStyleList(...t){var e,i,s;let r={};const o=(null===(e=this.el)||void 0===e?void 0:e.style.length)||0;for(var n=0;n<o;n++){var l=null===(i=this.el)||void 0===i?void 0:i.style[n];r[l]=(null===(s=this.el)||void 0===s?void 0:s.style)[l]}return t.forEach(t=>{r[t]=this.css(t)}),r}cssText(t){var e;return o(t)?null===(e=this.el)||void 0===e?void 0:e.style.cssText:(this.el&&(this.el.style.cssText=t),this)}cssFloat(t){return parseFloat(this.css(t))}cssInt(t){return parseInt(this.css(t))}px(t,e){return this.css(t,e+"px")}rect(){var t;return null===(t=this.el)||void 0===t?void 0:t.getBoundingClientRect()}isSVG(){var t;return"SVG"===(null===(t=this.el)||void 0===t?void 0:t.tagName.toUpperCase())}offsetRect(){var t,e,i,s,r,o;if(this.isSVG()){const t=this.parent().rect(),e=this.rect();return{x:e.x-t.x,y:e.y-t.y,top:e.x-t.x,left:e.y-t.y,width:e.width,height:e.height}}return{x:null===(t=this.el)||void 0===t?void 0:t.offsetLeft,y:null===(e=this.el)||void 0===e?void 0:e.offsetTop,top:null===(i=this.el)||void 0===i?void 0:i.offsetTop,left:null===(s=this.el)||void 0===s?void 0:s.offsetLeft,width:null===(r=this.el)||void 0===r?void 0:r.offsetWidth,height:null===(o=this.el)||void 0===o?void 0:o.offsetHeight}}offset(){var t=this.rect(),e=ae.getScrollTop(),i=ae.getScrollLeft();return{top:t.top+e,left:t.left+i}}offsetLeft(){return this.offset().left}offsetTop(){return this.offset().top}position(){var t;return(null===(t=this.el)||void 0===t?void 0:t.style.top)?{top:parseFloat(this.css("top")),left:parseFloat(this.css("left"))}:this.rect()}size(){return[this.width(),this.height()]}width(){var t;return(null===(t=this.el)||void 0===t?void 0:t.offsetWidth)||this.rect().width}contentWidth(){return this.width()-this.cssFloat("padding-left")-this.cssFloat("padding-right")}height(){var t;return(null===(t=this.el)||void 0===t?void 0:t.offsetHeight)||this.rect().height}contentHeight(){return this.height()-this.cssFloat("padding-top")-this.cssFloat("padding-bottom")}val(t){if(o(t))return this.el.value;if(n(t)){var e=t;t instanceof ae&&(e=t.val()),this.el.value=e}return this}matches(t){var e,i;return this.el&&(null===(e=this.el)||void 0===e?void 0:e.matches)?(null===(i=this.el)||void 0===i?void 0:i.matches(t))?this:this.parent().matches(t):null}get value(){return this.el?this.el.value:""}get files(){const t=this.el;return(null==t?void 0:t.files)?[...null==t?void 0:t.files]:[]}show(t="block"){return this.css("display","none"!=t?t:"block")}hide(){return this.css("display","none")}isHide(){return"none"==this.css("display")}isShow(){return!this.isHide()}toggle(t=!1){var e=this.isHide();return 1==arguments.length?t?this.show():this.hide():e?this.show():this.hide()}scrollIntoView(){var t;null===(t=this.el)||void 0===t||t.scrollIntoView()}setScrollTop(t){return this.el&&(this.el.scrollTop=t),this}setScrollLeft(t){return this.el&&(this.el.scrollLeft=t),this}scrollTop(){var t;return this.el===document.body?ae.getScrollTop():null===(t=this.el)||void 0===t?void 0:t.scrollTop}scrollLeft(){var t;return this.el===document.body?ae.getScrollLeft():null===(t=this.el)||void 0===t?void 0:t.scrollLeft}scrollHeight(){var t;return null===(t=this.el)||void 0===t?void 0:t.scrollHeight}scrollWidth(){var t;return null===(t=this.el)||void 0===t?void 0:t.scrollWidth}on(t,e,i){var s;return null===(s=this.el)||void 0===s||s.addEventListener(t,e,i),this}off(t,e){var i;return null===(i=this.el)||void 0===i||i.removeEventListener(t,e),this}getElement(){return this.el}createChild(t,e="",i={},s={}){let r=ae.create(t,e,i);return r.css(s),this.append(r),r}get firstChild(){var t;return ae.create(null===(t=this.el)||void 0===t?void 0:t.firstElementChild)}children(){var t,e=null===(t=this.el)||void 0===t?void 0:t.firstElementChild;if(!e)return[];var i=[];do{i.push(ae.create(e)),e=e.nextElementSibling}while(e);return i}childLength(){var t;return null===(t=this.el)||void 0===t?void 0:t.children.length}replace(t){var e,i,s;return(null===(e=this.el)||void 0===e?void 0:e.parentNode)&&(t instanceof ae?null===(i=this.el)||void 0===i||i.parentNode.replaceChild(t.el,this.el):null===(s=this.el)||void 0===s||s.parentNode.replaceChild(t,this.el)),this}replaceChild(t,e){var i;const s=t instanceof ae?t.el:t,r=e instanceof ae?e.el:e;return null===(i=this.el)||void 0===i||i.replaceChild(r,s),this}checked(t=!1){return 0==arguments.length?Boolean(this.el.checked):(this.el&&(this.el.checked=Boolean(t)),this)}click(){var t;return null===(t=this.el)||void 0===t||t.click(),this}focus(){var t;return null===(t=this.el)||void 0===t||t.focus(),this}blur(){var t;return null===(t=this.el)||void 0===t||t.blur(),this}select(){return this.el.select(),this}fullscreen(){const t=this.el;(null==t?void 0:t.requestFullscreen)&&t.requestFullscreen()}}const he={touchstart:!0,touchmove:!0,mousedown:!0,mouseup:!0,mousemove:!0,wheel:!0,mousewheel:!0};class de extends se{constructor(){super(...arguments),this._domEvents=void 0,this._bindings=[]}initialize(){this.destroy(),this._domEvents||(this._domEvents=this.filterProps(y)),this._domEvents.forEach(t=>this.parseEvent(t))}destroy(){this.removeEventAll()}removeEventAll(){var t;null===(t=this.getBindings())||void 0===t||t.forEach(t=>{this.removeEvent(t)}),this.initBindings()}removeEvent({eventName:t,dom:e,callback:i}){Zt(e,t,i)}getBindings(){return this._bindings||this.initBindings(),this._bindings}addBinding(t){var e;null===(e=this.getBindings())||void 0===e||e.push(t)}initBindings(){this._bindings=[]}matchPath(t,e){if(t)return e&&t.matches(e)?t:this.matchPath(t.parentElement,e)}hasDelegate(t,e){return this.matchPath(t.target||t.srcElement,null==e?void 0:e.delegate)}makeCallback(t,e){return t.delegate?this.makeDelegateCallback(t,e):this.makeDefaultCallback(t,e)}makeDefaultCallback(t,e){return i=>{var s=this.runEventCallback(i,t,e);if(n(s))return s}}makeDelegateCallback(t,e){return i=>{const s=this.hasDelegate(i,t);if(s){i.$dt=ae.create(s);var r=this.runEventCallback(i,t,e);if(n(r))return r}}}runEventCallback(t,e,i){const s=this.context;if(t.xy=te(t),e.beforeMethods.length&&e.beforeMethods.every(e=>null==s?void 0:s.getMethod(e.target).call(s,t,e.param)),this.checkEventType(t,e)){var r=i(t,t.$dt,t.xy);return!1!==r&&e.afterMethods.length&&e.afterMethods.forEach(e=>null==s?void 0:s.getMethod(e.target).call(s,t,e.param)),r}}checkEventType(t,e){const i=this.context;var s=!0;e.codes.length&&(s=!!t.code&&e.codes.indexOf(t.code.toLowerCase())>-1||!!t.key&&e.codes.indexOf(t.key.toLowerCase())>-1);var r=!0;return e.checkMethodList.length&&(r=e.checkMethodList.every(e=>{var s=null==i?void 0:i.getMethod(e);return c(s)&&s?s.call(i,t):!n(s)||Boolean(s)})),s&&r}getDefaultDomElement(t){const e=this.context;let i;return i=t?(null==e?void 0:e.refs[t])||(null==e?void 0:e.getMethod(t))||window[t]:null==e?void 0:e.$el,i instanceof ae?i.getElement():i}getDefaultEventObject(t,e){const i=this.context;let s=e;const r=s.filter(t=>!!(null==i?void 0:i.getMethod(t))),[o,n]=this.splitMethodByKeyword(s,"after"),[l,a]=this.splitMethodByKeyword(s,"before"),[h,d]=this.splitMethodByKeyword(s,"debounce"),[c,u]=this.splitMethodByKeyword(s,"throttle"),[v]=this.splitMethodByKeyword(s,"capture"),p=[...r,...o,...l,...h,...c,...v];return{eventName:t,codes:s.filter(t=>-1===p.indexOf(t)).map(t=>t.toLowerCase()),captures:v,afterMethods:n,beforeMethods:a,debounceMethods:d,throttleMethods:u,checkMethodList:r}}addEvent(t,e){t.callback=this.makeCallback(t,e),this.addBinding(t);const i=!!t.captures.length;let s=i;he[t.eventName]&&(s={passive:!0,capture:i}),Jt(t.dom,t.eventName,t.callback,s)}bindingEvent([t,s,...r],o,n){let l=this.getDefaultEventObject(t,o);if(l.dom=this.getDefaultDomElement(s),l.delegate=r.join(x),l.debounceMethods.length)n=e(n,+l.debounceMethods[0].target);else if(l.throttleMethods.length){n=i(n,+l.throttleMethods[0].target)}this.addEvent(l,n)}getEventNames(t){let e=[];return t.split(b).forEach(t=>{var i=t.split(b);e.push(...i)}),e}parseEvent(t){const e=this.context;let i=t.split(T).map(t=>t.trim());var s=i.shift().split(M)[1].split(x),r=this.getEventNames(s[0]),o=null==e?void 0:e.getMethod(t).bind(e);r.forEach(t=>{s[0]=t,this.bindingEvent(s,i,o)})}}class ce extends se{load(...t){this.bindData(...t)}bindData(...t){this._bindMethods||(this._bindMethods=this.filterProps(C)),this._bindMethods.filter(e=>{if(!t.length)return!0;var[i,s]=e.split(T),[r,o]=i.split(" ");return t.indexOf(o)>-1}).forEach(e=>{var i,r;const n=null===(i=this.context)||void 0===i?void 0:i.getMethod(e);var[e,u]=e.split(T);const v=this.getRef(u);let p=qt;""!=v&&a(v)?p=()=>{var t,e;return(null===(t=this.context)||void 0===t?void 0:t.prevState[v])!==(null===(e=this.context)||void 0===e?void 0:e.state[v])}:c(v)&&(p=v);const f=e.split(S)[1];let m=null===(r=this.context)||void 0===r?void 0:r.refs[f];const g=c(p)&&p.call(this.context);if(m&&g){const e=n.call(this.context,...t);if(!e)return;s(e,(t,e)=>{((t,e,i)=>{var r;"cssText"!==e?"style"!==e?"class"!==e?o(i)?t.removeAttr(e):"TEXTAREA"===(null===(r=null==t?void 0:t.el)||void 0===r?void 0:r.nodeName)&&"value"===e||"text"===e||"textContent"===e?t.text(i):"innerHTML"===e||"html"===e?t.html(i):"value"===e?t.val(i):t.attr(e,i):l(i)?t.addClass(...i):d(i)?s(i,(e,i)=>t.toggleClass(e,i)):t.addClass(i):h(i)&&t.css(i):t.cssText(i)})(m,t,e)})}})}destroy(){this._bindMethods=void 0}}const ue="add/body/mousemove",ve="add/body/mouseup",pe="ref",fe=ae.create("div"),me={constructor:!0,initState:!0,refresh:!0,updateData:!0,initializeProperty:!0,created:!0,getRealEventName:!0,initializeStoreEvent:!0,destoryStoreEvent:!0,destroy:!0,emit:!0,trigger:!0,on:!0,off:!0,setState:!0,_reload:!0,render:!0,initialize:!0,afterRender:!0,components:!0,getRef:!0,parseTemplate:!0,childrenIds:!0,exists:!0,parseProperty:!0,parseSourceName:!0,parseComponent:!0,clean:!0,loadTemplate:!0,load:!0,bindData:!0,template:!0,eachChildren:!0,initializeEvent:!0,collectProps:!0,filterProps:!0,self:!0,isAltKey:!0,isCtrlKey:!0,isShiftKey:!0,isMetaKey:!0,preventDefault:!0,stopPropagation:!0,bodyMouseMove:!0,bodyMouseUp:!0};const ge=/^ME@/,ye="ME@",Ee=(...t)=>t.join("|"),Ce=(...t)=>ye+Ee(...t);class be extends class{constructor(t,e){this.opt={},this.props={},this.$store=void 0,this.$root=void 0,this.state={},this.prevState={},this.refs={},this.children={},this.id=m(),this.handlers=this.initializeHandler(),this.childComponents={},this.childComponentKeys=[],this.childComponentSet=new Map,this.childComponentKeysString="",this.sourceName=this.constructor.name,this.initializeProperty(t,e),this.initComponents()}setStore(t){this.$store=t}setRoot(t){this.$root=t}initializeProperty(t,e){}initComponents(){this.childComponents=this.components(),this.childComponentKeys=Object.keys(this.childComponents),this.childComponentSet=new Map,this.childComponentKeys.forEach(t=>{this.childComponentSet.set(t.toLowerCase(),t)}),this.childComponentKeysString=[...this.childComponentSet.keys()].join(",")}initializeHandler(){return[new ce(this),new de(this)]}initState(){return{}}setState(t={},e=!0){this.prevState=this.state,this.state=Object.assign({},this.state,t),e&&this.load()}_reload(t){this.props=t,this.state={},this.setState(this.initState(),!1),this.refresh()}render(t){this.$el=this.parseTemplate(this.template()),this.refs.$el=this.$el,t&&t.append(this.$el),this.load(),this.afterRender()}initialize(){this.state=this.initState()}afterRender(){}components(){return{}}getRef(...t){const e=t.join("");return this.refs[e]}getMethod(t){return this[t]}parseTemplate(t,e=!1){let i="";i=l(t)?t.join(""):t;const s=(null==fe?void 0:fe.html(p`${i}`)).children();return s.forEach(t=>{const e=t.attr(pe);e&&(this.refs[e]=t);const i=t.$$("[ref]");let s={};i.forEach(t=>{const i=t.attr(pe);s[i]?console.warn(`${e} is duplicated. - ${this.sourceName}`,this):s[i]=!0,this.refs[i]=t})}),e?fe.createChildrenFragment():s[0]}childrenIds(){return r(this.children,(t,e)=>e.id)}exists(){return!this.parent||!c(this.parent.childrenIds)||this.parent.childrenIds().indexOf(this.id)>-1}parseProperty(t){var e;let i={};return Object.keys((null===(e=null==t?void 0:t.el)||void 0===e?void 0:e.attributes)||{}).forEach(e=>{var s;const r=(null===(s=null==t?void 0:t.el)||void 0===s?void 0:s.attributes)[e];i[r.nodeName]=r.nodeValue}),t.$$("property").forEach(t=>{const[e,s,r]=t.attrs("name","value","type");let o=s||t.text();"json"===r&&(o=JSON.parse(o)),e&&(i[e]=o)}),i}parseSourceName(t){return t.parent?[t.sourceName,...this.parseSourceName(t.parent)]:[t.sourceName]}parseComponent(){const t=this.$el;let e=[];this.childComponentKeysString&&(e=t.$$(this.childComponentKeysString)),e.forEach(t=>{var e,i=null===(e=null==t?void 0:t.el)||void 0===e?void 0:e.tagName.toLowerCase(),s=this.childComponentSet.get(i),r=this.childComponents[s];let o=this.parseProperty(t),n=t.attr(pe);var l=null;this.children[n]?(l=this.children[n])._reload(o):(l=new r(this,o),this.children[n||l.id]=l,l.render()),t.replace(l.$el)}),s(this.children,(t,e)=>{e&&e.clean()&&delete this.children[t]})}clean(){if(this.$el&&!this.$el.hasParent())return s(this.children,(t,e)=>{e.clean()}),this.destroy(),this.$el=null,!0}refresh(){this.load()}loadTemplate(...t){return this.getMethod(Wt(t.join(""))).call(this)}load(...t){this._loadMethods||(this._loadMethods=this.filterProps(E)),this._loadMethods.filter(e=>{const i=e.split(N)[1].split(T)[0];return!t.length||t.indexOf(i)>-1}).forEach(e=>{let i=e.split(N)[1];var[s,...r]=i.split(T).map(t=>t.trim());r=r.map(t=>t.trim());const o=Boolean(r.filter(t=>Ht.includes(t)).length);if(this.refs[s]){var n=this.getMethod(e).call(this,...t);const i=this.parseTemplate(n,!0);o?this.refs[s].htmlDiff(i):this.refs[s].html(i)}}),this.runHandlers("initialize"),this.bindData(),this.parseComponent()}runHandlers(t="run",...e){this.handlers.forEach(i=>i[t](...e))}bindData(...t){this.runHandlers("load",...t)}template(){return"<div></div>"}eachChildren(t){c(t)&&s(this.children,(e,i)=>{t(i)})}rerender(){var t=this.$el.parent();this.destroy(),this.render(t)}destroy(){this.eachChildren(t=>{t.destroy()}),this.runHandlers("destroy"),this.$el.remove(),this.$el=null,this.refs={},this.children={}}collectProps(){var t=this.getMethod("__proto__"),e=[];do{if(!1===t instanceof Object)break;const i=Object.getOwnPropertyNames(t).filter(t=>this&&c(this[t])&&!me[t]);e.push(...i),t=t.__proto__}while(t);return e}filterProps(t){return this.collectProps().filter(e=>e.match(t))}self(t){return Boolean(t&&t.$dt&&t.$dt.is(t.target))}isAltKey(t){return Boolean(t.altKey)}isCtrlKey(t){return Boolean(t.ctrlKey)}isShiftKey(t){return Boolean(t.shiftKey)}isMetaKey(t){return Boolean(t.metaKey||"Meta"==t.key||t.code.indexOf("Meta")>-1)}preventDefault(t){return t.preventDefault(),!0}stopPropagation(t){return t.stopPropagation(),!0}emit(t,...e){}trigger(t,...e){}bodyMouseMove(t,e){this.getMethod(e)&&this.emit(ue,this.getMethod(e),this,t.xy)}bodyMouseUp(t,e){this.getMethod(e)&&this.emit(ve,this.getMethod(e),this,t.xy)}}{constructor(t,e={}){super(t,e),this.opt={},this.parent=void 0,this.props={},this.source="",this.sourceName="",this.created(),this.initialize(),this.initializeStoreEvent()}initializeProperty(t,e={}){this.opt=t||{},this.parent=this.opt,this.props=e,this.source=m(),this.sourceName=this.constructor.name,t&&t.$store&&(this.$store=t.$store),t&&t.$root&&(this.$root=t.$root)}created(){}getRealEventName(t,e="ME@"){var i=t.indexOf(e);return t.substr(i<0?0:i+e.length)}initializeStoreEvent(){this.filterProps(ge).forEach(t=>{const e=this.getRealEventName(t,ye);var[i,s]=((t,e)=>{const i=t.filter(t=>t.indexOf(e+"(")>-1),s=i.map(t=>{const[i,s]=t.split(e+"(")[1].split(")")[0].trim().split(" ");return{target:i,param:s}});return[i,s]})(e.split("|"),"debounce"),r=0;i.length&&(r=+s[0].target||0),e.split("|").filter(t=>-1===i.indexOf(t)).map(t=>t.trim()).forEach(e=>{var i,s=this[t].bind(this);s.displayName=`${this.sourceName}.${e}`,s.source=this.source,null===(i=this.$store)||void 0===i||i.on(e,s,this,r)})})}destoryStoreEvent(){var t;null===(t=this.$store)||void 0===t||t.offAll(this)}destroy(){super.destroy(),this.destoryStoreEvent()}rerender(){super.rerender(),this.initialize(),this.initializeStoreEvent()}emit(t,...e){var i;this.$store&&(this.$store.source=this.source,this.$store.sourceContext=this,null===(i=this.$store)||void 0===i||i.emit(t,...e))}trigger(t,...e){var i;this.$store&&(this.$store.source=this.source,null===(i=this.$store)||void 0===i||i.trigger(t,...e))}on(t,e){var i;null===(i=this.$store)||void 0===i||i.on(t,e,this)}off(t,e){var i;null===(i=this.$store)||void 0===i||i.off(t,e)}}const Te={x:0,y:0},Me={x:Number.MAX_SAFE_INTEGER,y:Number.MAX_SAFE_INTEGER};t.AFTER=St,t.ALT=_t,t.ANIMATIONEND=yt,t.ANIMATIONITERATION=Et,t.ANIMATIONSTART=gt,t.ARROW_DOWN=Rt,t.ARROW_LEFT=kt,t.ARROW_RIGHT=wt,t.ARROW_UP=Ot,t.BEFORE=(t,e=T)=>g(`before(${t})`,e),t.BIND=(t="$el",e="")=>S+t+(e?T+Yt(e):""),t.BIND_CHECK_DEFAULT_FUNCTION=qt,t.BIND_SAPARATOR=S,t.BLUR=lt,t.CAPTURE=Vt,t.CHANGE=it,t.CHANGEINPUT=ft,t.CHECKER=Nt,t.CHECK_BIND_PATTERN=C,t.CHECK_DOM_EVENT_PATTERN=y,t.CHECK_LOAD_PATTERN=E,t.CHECK_SAPARATOR=T,t.CLICK=w,t.CONTEXTMENU=et,t.CONTROL=Bt,t.CUSTOM=k,t.D1000=zt,t.DEBOUNCE=jt,t.DOM_EVENT_MAKE=O,t.DOM_EVENT_SAPARATOR=M,t.DOUBLECLICK=D,t.DRAG=G,t.DRAGEND=tt,t.DRAGENTER=q,t.DRAGEXIT=Z,t.DRAGLEAVE=J,t.DRAGOUT=Q,t.DRAGOVER=Y,t.DRAGSTART=X,t.DROP=W,t.Dom=ae,t.END=(t="end")=>St("bodyMouseUp "+t),t.ENTER=Dt,t.ESCAPE=$t,t.EVENT=Ce,t.FIT=Ft,t.FOCUS=rt,t.FOCUSIN=ot,t.FOCUSOUT=nt,t.IF=xt,t.INPUT=st,t.KEY=At,t.KEYDOWN=j,t.KEYPRESS=V,t.KEYUP=z,t.LOAD=Wt,t.LOAD_SAPARATOR=N,t.META=It,t.MOUSEDOWN=P,t.MOUSEENTER=B,t.MOUSELEAVE=K,t.MOUSEMOVE=_,t.MOUSEOUT=I,t.MOUSEOVER=L,t.MOUSEUP=$,t.MOVE=(t="move")=>St("bodyMouseMove "+t),t.NAME_SAPARATOR=b,t.PASSIVE=Ut,t.PASTE=at,t.PIPE=Ee,t.POINTEREND=pt,t.POINTERMOVE=vt,t.POINTERSTART=ut,t.PREVENT=Gt,t.RESIZE=ht,t.SAPARATOR=x,t.SCROLL=dt,t.SELF=Kt,t.SHIFT=Lt,t.SPACE=Pt,t.STOP=Xt,t.SUBMIT=ct,t.THROTTLE=(t=100)=>xt(`throttle(${t})`),t.TOUCHEND=H,t.TOUCHMOVE=U,t.TOUCHSTART=F,t.TRANSITIONCANCEL=Mt,t.TRANSITIONEND=bt,t.TRANSITIONRUN=Tt,t.TRANSITIONSTART=Ct,t.UIElement=be,t.VDOM=Ht,t.WHEEL=mt,t.addEvent=Jt,t.clone=function(t){return JSON.parse(JSON.stringify(t))},t.createRef=Yt,t.debounce=e,t.getRef=t=>A[t]||"",t.html=p,t.isArray=l,t.isBoolean=function(t){return"boolean"==typeof t},t.isFunction=c,t.isNotString=h,t.isNotUndefined=n,t.isNumber=u,t.isObject=d,t.isString=a,t.isUndefined=o,t.keyEach=s,t.keyMap=r,t.makeEventChecker=g,t.pos=Qt,t.posXY=te,t.removeEvent=Zt,t.render=t=>{class i extends be{constructor(){super(...arguments),this.$container=void 0,this.moves=void 0,this.ends=void 0,this.funcBodyMoves=void 0,this.state={},this.requestId=-1}initialize(){this.setStore(new ee),this.setRoot(this);const t=this.getContainer();this.$container=ae.create(t),this.$container.addClass(this.getClassName()),this.render(this.$container),this.initBodyMoves()}initState(){return{pos:{},oldPos:{}}}initBodyMoves(){this.moves=new Set,this.ends=new Set,this.modifyBodyMoveSecond(0)}modifyBodyMoveSecond(t=0){this.funcBodyMoves=e(this.loopBodyMoves.bind(this),t)}loopBodyMoves(){var t;const{bodyEvent:e,pos:i,lastPos:s}=this.state,r=s||Me;!(r.x===(null==i?void 0:i.x)&&r.y===(null==i?void 0:i.y))&&(null===(t=this.moves)||void 0===t?void 0:t.size)&&(this.moves.forEach(t=>{const s=((null==i?void 0:i.x)||0)-t.xy.x,r=((null==i?void 0:i.y)||0)-t.xy.y;0==s&&0==r||t.func.call(t.context,s,r,"move",e.pressure)}),this.state.lastPos=i),this.funcBodyMoves&&window.requestAnimationFrame(this.funcBodyMoves)}removeBodyMoves(){var t,e,i;const{pos:s,bodyEvent:r}=this.state;s&&(null===(t=this.ends)||void 0===t||t.forEach(t=>{t.func.call(t.context,((null==s?void 0:s.x)||0)-t.xy.x,((null==s?void 0:s.y)||0)-t.xy.y,"end",r.pressure)})),null===(e=this.moves)||void 0===e||e.clear(),null===(i=this.ends)||void 0===i||i.clear()}[Ce(ue)](t,e,i){var s;null===(s=this.moves)||void 0===s||s.add({func:t,context:e,xy:i})}[Ce(ve)](t,e,i){var s;null===(s=this.ends)||void 0===s||s.add({func:t,context:e,xy:i})}getClassName(){return t.className||"sapa"}getContainer(){return t.container||document.body}template(){return""+t.template}components(){return t.components||{}}[vt("document")](t){var e=this.state.pos||Te,i=t.xy||Te;this.setState({bodyEvent:t,pos:i,oldPos:e},!1),-1===this.requestId&&this.funcBodyMoves&&(this.requestId=window.requestAnimationFrame(this.funcBodyMoves))}[pt("document")](t){var e=t.xy||Te;"INPUT"!==t.target.nodeName&&"SELECT"!==t.target.nodeName&&"TEXTAREA"!==t.target.nodeName&&(this.setState({bodyEvent:t,pos:e},!1),this.removeBodyMoves(),this.requestId=-1)}}return new i(t)},t.throttle=i,t.uuid=m,t.uuidShort=function(){var t=(new Date).getTime();return"idxxxxxxx".replace(f,(function(e){var i=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?i:3&i|8).toString(16)}))},Object.defineProperty(t,"__esModule",{value:!0})}));
